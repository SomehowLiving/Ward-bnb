## GitHub Copilot – Frontend Build Prompt (MVP, Do Not Overbuild)

You are building a **production-grade but MVP-scoped Web3 frontend** for a **Pocket-based transaction protection system**.

### Tech Stack (fixed)

* React + TypeScript
* ethers v6
* Wallet connection via wagmi / viem **or** ethers `BrowserProvider`
* Backend base URL: `http://localhost:3000`
* All backend APIs are already implemented in `server.js` and **must be used as-is**

---

## Core Product Concept

Users **never interact directly with risky contracts**.

They:

1. Create a Pocket (single-use execution vault)
2. Simulate and review an action
3. Sign intent (EIP-712)
4. Backend relays execution

---

## HARD CONSTRAINTS (DO NOT IGNORE)

* Do NOT over-engineer
* Do NOT introduce abstractions beyond basic hooks
* Do NOT add caching, polling, or background sync
* Do NOT add analytics, dashboards, or history views
* Do NOT support multiple chains
* Do NOT add role systems or permissions
* Use React `useState` / `useEffect` only
* One happy path + basic error handling is enough

This is an MVP. Ship fast.

---

## Required Pages & Routes (ONLY THESE)

---

### 1. `/` – Dashboard

**Purpose**

* Wallet connect
* Show user pockets
* Entry point for all actions

**UI**

* Connect wallet button
* List of pockets with status
* Buttons: **Create Pocket**, **Open Pocket**

**APIs**

* `GET /api/pockets/:userAddress`
* Optional: `GET /api/history/:userAddress`

---

### 2. `/pocket/create`

**Purpose**

* One-click Pocket creation

**Rules**

* No wallet signature
* No advanced options

**API**

* `POST /api/pocket/create`

**After success**

* Redirect to `/pocket/[address]`

---

### 3. `/pocket/[address]` – Pocket Detail

**Display**

* Pocket address
* Owner
* Status: unused / used / burned

**Actions**

* Execute transaction
* Sweep funds
* Burn pocket

**APIs**

* `GET /api/pocket/:address`
* `GET /api/controller/pocket/:address`

**Rules**

* Disable all actions if pocket is used or burned

---

### 4. `/pocket/[address]/execute` – Execute Wizard (CRITICAL)

This **must be a step-by-step wizard**.
Do not collapse steps or skip validation.

---

#### Step 1: Transaction Input

User inputs:

* Target contract address
* Action type:

  * ERC20 approve
  * ERC20 transfer
  * Custom calldata
* Parameters

Generate calldata locally.

---

#### Step 2: Decode & Explain

Explain what the transaction does **before signing**.

**APIs**

* `POST /api/calldata/decode`
* `GET /api/token/:address` (if ERC20)

**UI**

* Function name
* Parameters
* Human-readable explanation

---

#### Step 3: Risk Analysis

**APIs**

* `POST /api/risk/classify`
* `POST /api/risk/simulate`

**Rules**

* Tier ≥ 3 → block execution
* Tier 2 → show warning + require confirmation
* Tier 1 → proceed normally

---

#### Step 4: Pre-flight Validation

**APIs**

* `POST /api/pocket/simulate`
* `POST /api/pocket/gas`

**UI**

* Gas estimate
* Clear success / failure indicator

---

#### Step 5: Sign Intent (EIP-712)

Client builds typed data:

**Domain**

* name: `"Ward Pocket"`
* version: `"1"`
* chainId: connected chain
* verifyingContract: pocket address

**Values**

* pocket
* target
* keccak256(calldata)
* nonce
* expiry

User signs with wallet.

---

#### Step 6: Verify Signature

**API**

* `POST /api/verify/exec-intent`

If invalid → block execution.

---

#### Step 7: Execute

**API**

* `POST /api/pocket/exec`

**UI**

* Show tx hash
* Mark pocket as used
* Disable future actions

---

### 5. `/pocket/[address]/sweep`

**Purpose**

* Emergency fund extraction

**APIs**

* `POST /api/pocket/fee`
* `POST /api/pocket/sweep`

**UI**

* Fee
* Net amount
* Risk tier

---

### 6. `/pocket/[address]/burn`

**Purpose**

* Permanently disable pocket

**API**

* `POST /api/pocket/burn`

**Rule**

* Explicit confirmation required

---

## Global Rules (MANDATORY)

* NEVER execute without:

  * risk classification
  * simulation
  * signature verification
* NEVER ask user to sign before showing decoded calldata
* ALWAYS block actions on used or burned pockets
* Validate addresses before sending requests
* Display backend error messages directly

---

## State Management (Minimal)

Track only:

* Wallet state (address, chainId)
* Pocket state (status, nonce)
* Execution state (draft → simulated → signed → executed)

Persist wizard progress per pocket (local state is fine).

---

## Deliverables Copilot Should Generate

* `src/api.ts` – typed API calls
* `usePocket`, `usePockets` hooks (simple, no caching)
* Execute wizard components
* EIP-712 signing helper
* Centralized error handling
* Basic address + calldata validation utils

---

## Explicit Non-Goals

* No backend logic
* No smart contract code
* No direct contract calls
* No private key handling
* No analytics or metrics UI
* No production polish beyond basic UX

---

**This is an MVP.
Correctness > features.
Do not overbuild.**

---